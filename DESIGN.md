## Design Details - AirAware

#### Tech Stack
- **Backend/control flow**: Python / Flask 
- **Fronted**: HTML / CSS / Bootstrap / JS 
- **Database**: SQLite3 (database)
- **Data prep**: Python / Pandas (Data cleaning, reshaping, analysis)
- **Version Control**: git for local version control (connection to github planned)

#### Dev tool
- Developed using PyCharm CE (free version of professional development tool focused on python, with support for sql, html, css)
  - More robust set of tools out of the box that VSCode
- Warp Terminal (Command Line & SQL tasks)
- Not tested on VSCode - should be fine

#### Libraries (Primary)
- CSV
- flask
- IO
- JSON
- Pandas
- Plotly
- SQLite3

#### Data Sources
- https://www.oxonair.uk (download of data)
- Dummy data based on the above data download - Generated by Claude (LLM)
- https://www.londonair.org.uk/Londonair/API/ (Planning to connect to API, not implemented)

#### Database structure
SQLite database with optimized schema

Four main tables:
- locations (main areas)
- sub_locations (specific measurement points)
- pollutants (types of air quality measurements)
- measurements (actual readings with timestamps)

Static dummy data used for this implementation, based off of the oxonair.uk structure. 
Dummy data was used as I didn't want to spend time early on creating a cleaning script, and actual data was less important than feature implementation.
I did end up making a script to prepare the data I downloaded but have not yet implemented into a pipeline for regular updates.
With the key features in place I can flow real data into the database, and it will cascade into the program.

#### Database set-up
- Schema defined in a python file (data/db_schema.sql)
- Python script used to set-up the sqlite3 database to avoid keying into sqlite3 directly via the terminal
  - (db_setup.py)
- Dummy data created and inserted into the sqlite3 database with python script - functions to be repurposed in the future for datapipeline
  - quite a bit of input from LLM to create the dummy data as I didn't want to spend time on generating realistic data


#### Database Schema
```
CREATE TABLE locations (
    location_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL UNIQUE
);
CREATE TABLE sqlite_sequence(name,seq);
CREATE TABLE sub_locations (
    sub_location_id INTEGER PRIMARY KEY AUTOINCREMENT,
    location_id INTEGER NOT NULL,
    name TEXT NOT NULL,
    UNIQUE(location_id, name),
    FOREIGN KEY (location_id) REFERENCES locations(location_id)
);
CREATE TABLE pollutants (
    pollutant_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL UNIQUE
);
CREATE TABLE measurements (
    measurement_id INTEGER PRIMARY KEY AUTOINCREMENT,
    sub_location_id INTEGER NOT NULL,
    pollutant_id INTEGER NOT NULL,
    value REAL NOT NULL,
    status TEXT NOT NULL,
    measured_at DATE NOT NULL,
    FOREIGN KEY (sub_location_id) REFERENCES sub_locations(sub_location_id),
    FOREIGN KEY (pollutant_id) REFERENCES pollutants(pollutant_id)
);
CREATE INDEX idx_measurements_date ON measurements(measured_at);
CREATE INDEX idx_measurements_location ON measurements(sub_location_id);
CREATE INDEX idx_measurements_pollutant ON measurements(pollutant_id);
```

#### Key Files
- app.py - Control file with all routes. File used to run flask app
- database_helpers.py - functions related to database actions
- graphing.py - functions related to graphs. Helper file without suffix.
- table_helpers.py - functions related to table builds.
- Templates directory:
    - explore_data.html - main table file with download option
    - graphs.html - page with graph on it
    - index.html - home page introducing the site and links to the main pages
    - layout.html - page layout file with JinJa placeholders used in other html files
    - plotly_table.html - page for the plotly table
- helpers.py - Not used. Functions copied over from another project for use in log-in and registration which I didn't get to.

#### Functions Overview
- All functions have docstrings (using google style) detailing what it does, params and outputs.

#### Project Structure
```

├── DECISIONS.md
├── DESIGN.md
├── LEARNING_OUTCOMES.md
├── NOTES.md
├── README.md
├── _Final-project-Nathan-Wiles-CS50-2024.key
├── app.py
├── data
│   ├── data_raw
│   │   ├── Oxford_air_cleaning.ipynb
│   │   └── data_sample
│   ├── db_schema.sql
│   ├── db_setup.py
│   ├── dummy_data_generation.py
│   └── querey.sql
├── database_helpers.py
├── flask_session
│   └── 2029240f6d1128be89ddc32729463129
├── graphing.py
├── helpers.py
├── requirements.txt
├── static
│   ├── air-icon.png
│   ├── air-pollution-illustration-concept-on-white-background-vector.jpg
│   ├── designs
│   │   └── webpage-wireframe.svg
│   └── styles.css
├── table_helpers.py
└── templates
    ├── explore_data.html
    ├── graphs.html
    ├── index.html
    ├── layout.html
    └── plotly_table.html

7 directories, 28 files

```

